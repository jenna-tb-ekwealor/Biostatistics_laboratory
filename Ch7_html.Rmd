---
title: "<center>Biostatistics - BIOL 260"
author: "<center>*Lab 7: The Normal Distribution*"
output:
  html_document: default
  pdf_document: default
---

<style type="text/css">
.main-container {
  max-width: 800px;
}
pre code, pre, code {
  white-space: pre !important;
  overflow-x: scroll !important;
  word-break: keep-all !important;
  word-wrap: initial !important;
}
/* Whole document: */
body{
  font-family: helvetica;
  font-size: 12pt;
}
code {white-space:pre !important; overflow-x:scroll !important;font-size:12pt; font-family:courier;}
</style>


<br><br>
<style>
body {
text-align: justify}
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

**Today's investigation.** Human-animal interactions can be defining moments in life. However, when resources become limited, these interactions develop into conflicts where humans compete and often displace and re-shape wild populations. This problem has motivated conservation biologists to study wild populations and contribute to solutions to the now increasing frequency of human-wildlife conflicts. A fundamental step in studying wild populations from a conservation biology perspective involves the description of its size - or age - structure and growth. Today, we will explore how to study some of these population parameters using *the normal distribution*, a statistical tool widely employed to describe many biological variables, with a dataset of round stingrays from the CSULB Shark Lab. 
    
</div>

***

<span style='color:#66023C; font-size:150%; font-weight:600'> Introduction </span>
<br>

In this lab we will examine *the normal distribution* and its *Z-score standardization* to describe the size structure of the round stingray population of Seal Beach, California (Figure 1). The increasing human population of southern California, coupled to the high population density of stingrays, has developed into a human-wildlife conflict resulting in many reported injuries. In order to maintain a balance between healthy fish populations and human recreation, it is crucial to understand key biological processes associated to the distribution of individuals in space. One of such processes is growth, a parameter defined by the change in size of the individuals across time. 

Today, we will test whether the size structure of round stingrays at southern California follows a normal distribution or whether it is shifted towards a particular size class. For this, we will use data from CSULB Shark Lab's surveys led by Dr. Chris Lowe (Figure 1). In his surveys, Dr. Lowe and colleagues used a large fishing seine (Figure 1, left panel) to capture and measure the body size of live round stingrays. So, let's explore the normal distribution and how it is a useful statistical tools for describing the proportion of sizes observed in this round stingray population.  


```{r echo=FALSE,fig.align="left",fig.width=8, fig.asp=.4,fig.cap="Figure 1. Round stingray Urobatis halleri collection and sampling. Stingrays were collected at Seal Beach, California. A 30 m long by 4.5 m tall seine was used to collect stingrays (left panel). The disc width of collected stingrays was measured (right panel). Images: Chris Lowe.",fig.height=4}
library(png)
library(grid)
img <- readPNG("image0.png")
grid.raster(img)
```
<br>


**Upon completion of this lab, you should be able to:**

  + define the normal distribution;
  + describe the properties of the normal distribution;
  + carry out the Z-standardization;
  + estimate the area under the normal curve (probability) for a particular range of values.

<br>

**External study resources:**

  + [Z-scores, standardization, and the standard normal distribution](https://www.youtube.com/watch?v=2tuBREK_mgE)

<br>

**References:**

  + [Hale and Lowe (2008)](https://onlinelibrary.wiley.com/doi/pdf/10.1111/j.1095-8649.2008.01940.x?casa_token=ZeyKYw0NtfQAAAAA:4LBl3vOXRCtkWAO2NCQ39VPisrV-dqditVfawI6ghSN4OwCiWxyh67OoFlGGlao5PSCPRpaGPBBJMG0)

***

<br>

<span style='color:#66023C; font-size:150%; font-weight:600'> Worked example </span> 
<br>

So far, we have seen several probability distributions. In Chapter 4, we introduced the population and sampling distributions, and in Chapter 5 we discussed the null probability distribution. If we look closer, all these probability distributions have a bell shape centered in a mean value. 

Let's explore this type of distribution commonly observed in biological data.

<br>

### 1. The normal distribution 

The normal distribution is a *continuous* probability distribution (see Chapter 4), meaning it describes the probability distribution of a *continuous* variable. It is symmetric and it is centered in its mean value. That is, the further a value is from the mean, the lower the probability density of observations.

Say we are interested in describing the diastolic blood pressure of a hypothetical human population of 20,0000 adults. After collecting the data, you observe the following distribution of values:

<br>

```{r,echo=FALSE,warning=FALSE,fig.align='left',fig.width=11,fig.cap="Figure 2. Frequency distribution of diastolic blood pressure for a theoretical human population (n = 20,000; left panel) and the probability density curve (right panel).",fig.height=5}
library(ggplot2)
library(ggpubr)
#bp = as.data.frame(rnorm(20000,70,10))
load("bp.RData")
p1=ggplot(bp,aes(x=bp[,1])) +
geom_histogram(binwidth=1,fill="cadetblue3",color="grey") +
theme_classic(18) +
scale_x_continuous(breaks = seq(30,120,20)) +
ylab("Number of adults") +
xlab("Diastolic blood pressure (mmHg)") +
geom_bracket(xmin = 70, xmax = 70, y.position = 830,label = "mean") +
  geom_bracket(xmin = 30, xmax = 60, y.position = 680,label = "Low observation density",size=1) +
  geom_bracket(xmin = 80, xmax = 110, y.position = 680,label = "Low observation density",size=1)

p2=ggplot(bp,aes(x=bp[,1])) +
geom_density(fill="cadetblue3",color="grey",size=2) +
theme_classic(18) +
scale_x_continuous(breaks = seq(30,120,20)) +
ylab("Probability density") +
xlab("Diastolic blood pressure (mmHg)")

library(gridExtra)
grid.arrange(p1,p2,ncol=2)
```

<br>

Such data has a mean = 70 mmHg and a standard deviation of 10 mmHg. Now, say we want to know how well these data fits a normal distribution. So, let's fit a normal distribution to this data (mean = 70, standard deviation = 10): 

<br>

```{r,fig.width=4.5,echo=FALSE,fig.cap="Figure 3. Fitted normal distribution (red curve).",fig.align='center',fig.height=3}
p2=ggplot(bp,aes(x=bp[,1])) +
geom_density(color="grey",size=2) +
theme_classic(15) +
scale_x_continuous(breaks = seq(30,120,20)) +
ylab("Probability density") +
xlab("Diastolic blood pressure (mmHg)")

p3=p2 + stat_function(fun = dnorm, n = 20000, args = list(mean = 70, sd = 10),colour="red") 
p3
```
  
<br>

In this case, the fitted normal distribution follows the observed data pretty well and thus we can be confident that our data is normally distributed (Figure 3). This brings us to an important aspect of the normal distribution: **a normal distribution is described by two parameters; the mean $\mu$ (location) and the standard deviation $\sigma$ (spread)**. As we discussed in Chapter 4, the *y*-axis shows a probability density (not a count), and thus to get the probability of a value of diastolic blood pressure, we need to calculate the area under the curve between the range (integration through calculus).

<br>

### 2. Properties of the normal distribution

There are common features in any normal distribution. It is continuous and symmetric, it has a single mode and the probability density is highest at the mean. In other words, in a normal distribution, the mean, the median, and the mode, are *all equal* to each other. 

Because of this, we can describe the area under the curve of a normal distribution using the location and the spread ($\mu$ and $\sigma$):


```{r,echo=FALSE,fig.width=4,fig.align='center',fig.height=3,warning=FALSE}
mean.1 <-0
sd.1 <- 1
zstart <- 2
zend <- 3
zcritical <- 1.65

my_col <- "cadetblue3"

x <- seq(from = mean.1 - 3*sd.1, to = mean.1 + 3*sd.1, by = .01)


MyDF <- data.frame(x = x, y = dnorm(x, mean = mean.1, sd = sd.1))

shade_curve <- function(MyDF, zstart, zend, fill = "red", alpha = .5){
    geom_area(data = subset(MyDF, x >= mean.1 + zstart*sd.1
                            & x < mean.1 + zend*sd.1),
              aes(y=y), fill = fill, color = NA, alpha = alpha)
}

p4 <- ggplot(MyDF, aes(x = x, y = y,colour="red")) + geom_line() +
    shade_curve(MyDF = MyDF, zstart = -1, zend = 1, fill = my_col, alpha = .3) +
    shade_curve(MyDF = MyDF, zstart = 1, zend = 2, fill = my_col, alpha = .5) +
    shade_curve(MyDF = MyDF, zstart = -2, zend = -1, fill = my_col, alpha = .5) +
    shade_curve(MyDF = MyDF, zstart = 2, zend = 6, fill = my_col, alpha = .7) +
    shade_curve(MyDF = MyDF, zstart = -3, zend = -2, fill = my_col, alpha = .7) +
    scale_x_continuous(breaks = NULL) +
    scale_y_continuous(breaks = NULL) +
    theme_classic() +
    ylab("") + xlab("") +
    annotate(geom="text", x=0,y=-.015, label=expression(paste(mu))) +
    annotate(geom="text", x=1,y=-.015, label=expression(paste(mu+sigma))) +
    annotate(geom="text", x=-1,y=-.015, label=expression(paste(mu-sigma))) +
    annotate(geom="text", x=2.1,y=-.015, label=expression(paste(mu+"2",sigma))) +
    annotate(geom="text", x=-1.9,y=-.015, label=expression(paste(mu-"2",sigma))) +
    geom_bracket(xmin = -1, xmax = 1, y.position = 0.15,label = "68.3%",size=1.5) +
    geom_bracket(xmin = -2, xmax = 2, y.position = 0.05,label = "95%",size=1.5) +
    theme(legend.position = "none", line = element_blank())

p4
```

In a normal distribution, 68.3% of the values are within ±1 standard deviation, while 95% of them are within ±2 standard deviations of the mean. That is, a randomly chosen observation drawn from a normal distribution has a 68.3% chance of falling between $\mu - \sigma$ and $\mu + \sigma$. Similarly, there is 95% chance that a randomly chosen observation falls within 2 standard deviations from the mean. For our example, 68.3% of the individuals have an expected diastolic blood pressure between 60-80 mmHg (mean ± 1SD) and 95% have an expected diastolic blood pressure between 50-90 mmHg, approximately (mean ± 2SD).  

<br>

### 3. The standard normal distribution

The standard normal distribution is a normal distribution of mean = 0 and standard deviation = 1 (Figure 4). A random variable with a standard normal distribution is called Z (or Z-score). A Z-score gives us an idea of how far from the mean a data point is. 

<br>

```{r,echo=FALSE,fig.width=4,fig.align='center',fig.height=3, fig.cap="Figure 4. The standard normal distribution."}
p5 <- ggplot(MyDF, aes(x = x, y = y)) + 
    geom_line() +
    scale_x_continuous(breaks = NULL) +
    scale_y_continuous(breaks = NULL) +
    theme_classic(15) +
    ylab("Probability density") + xlab("Z")  + 
    shade_curve(MyDF = MyDF, zstart = 1.96, zend = 3, fill = my_col, alpha = .3) +
    annotate(geom="text", x=0,y=-.02, label="0") +
    annotate(geom="text", x=1,y=-.02, label="1") +
    annotate(geom="text", x=-1,y=-.02, label="-1") +
    annotate(geom="text", x=2,y=-.02, label="2") +
    annotate(geom="text", x=-2,y=-.02, label="-2") +
    annotate(geom="text", x=-3,y=-.02, label="-3") +
    annotate(geom="text", x=3,y=-.02, label="3") +
    annotate(geom="text", x=2.8,y=.05, label="2.5%") +
    geom_segment(aes(x = -3, y = 0, xend = 3, yend = 0)) +
    geom_segment(aes(x = -3, y = 0, xend = -3, yend = 0.4)) +
    geom_segment(aes(x = 1.96, y = 0, xend = 1.96, yend = 0.1)) +
    annotate(geom="text", x=2.5,y=.12, label="Z = 1.96") +
    theme(legend.position = "none", line = element_blank())
p5
```

<br>

This standardization of the normal distribution is useful because it allows us to (a) calculate the probability of a Z-score occurring and (b) compare two Z-scores from different normal distributions. Before discussing each one of these two steps, keep in mind that any normally distributed variable can be standardized for mean = 0 and standard deviation = 1 with the following equation:

<br>

<center>
$$
\begin{aligned}
 Z=\frac{Y-\mu}{\sigma},\\\\
\end{aligned}
$$
</center>

where Z is a normal random variable, Y is an observation, $\mu$ is the mean, and $\sigma$ is the standard deviation.

<br>

*(a) Probability of a Z-score occurring:*

A random sample from the standard normal distribution will have 95% chance to fall between -2 and 2, approximately (Figure 4). More exactly, 95% of samples fall within 1.96 standard deviations of the mean (not 2). A statistical table helps us to estimate the probability of obtaining a range of values under the curve or the area under the curve (Figure 4). Following our example, say that a new drug for blood pressure is being used. However, this drug has severe adverse effects in individuals with a diastolic blood pressure lower than 40 mmHg and higher than 100 mmHg. So, what is the probability that an adult has a diastolic blood pressure (DBP) lower than 40 mmHg or higher than 100 mmHg? 

Here, we followed the addition rule for mutually exclusive events:

<br>

$$
\begin{aligned}
 Pr[DBP < 40\ mmHg\ or\ DBP>100\ mmHg]&=Pr[DBP<40\ mmHg]+Pr[DBP>100\ mmHg]
\end{aligned}
$$

<br>

To solve this, the first step is to standardized 100 mmHg to a Z-score:

<br>

<center>
$$
\begin{aligned}
 Z=\frac{100\ mmHg-70\ mmHg}{10\ mmHg}=3\ mmHg.\\\\
\end{aligned}
$$
</center>


That is, 100 mmHg occurs at 3 standard deviations above the mean. To know Pr[Z > 3] or the area under the standard normal curve for Z values > 3, we use the statistical table which indicates a probability of Pr[Z > 3] = 1 - 0.9987 = 0.0013. In other words, 0.13% of adults have a diastolic blood pressure higher than 100 mmHg. 

Similarly for 40 mmHg, we standardize it and obtain the area under the curve using the statistical table:

<br>

<center>
$$
\begin{aligned}
 Z=\frac{40\ mmHg-70\ mmHg}{10\ mmHg}=-3\ mmHg.\\\\
\end{aligned}
$$
</center>


In this case, 40 mmHg occurs at 3 standard deviations below the mean. Keep in mind that the normal distribution is simetrical and thus, the probability of being 3 standard deviations *below* the mean is the same as 3 standard deviations *above* the mean. When looking at the statistical table, that is a probability of Pr[Z < 3] = 0.0013. 

<br>

Thus, 

<br>

$$
\begin{aligned}
 Pr[DBP < 40\ mmHg\ or\ DBP>100\ mmHg]&=Pr[DBP<40\ mmHg]+Pr[DBP>100\ mmHg]\\\\
 &=0.0026.
\end{aligned}
$$


For our example, 0.26% of adults could suffer severe adverse effects from the new drug.

<br>

*(b) Comparing two Z-scores from different normal distributions:*

The standardization allows us to compare Z-scores with no limitations. Take a Z-score of 2.7 mmHg and another from another hypothetical human population of 3.1 mmHg. With no other information, we know that the second population has a Z-score 0.4 values farther from its mean than the first one (3.1 mmHg - 2.7 mmHg). Hence, we can also use standardization to compare the spread of the curve.  
<br>

### 4. The normal distribution as the sampling distribution

In Chapter 4, we studied the population and sampling distributions. The former is the whole set of values we are interested in and the latter is the probability distribution of all values for a sample statistic we might obtain when sampling the population. As we usually do not have data for *all* individuals in a population, we need to estimate the sampling distribution of the statistic of interest. The normal distribution is perfect for that! That is, if variable Y is normally distributed in the population (in our case the diastolic blood pressure), then the distribution of sample means $\overline{y}$ is also normal (review the central limit theorem in Info-Box!). 

In chapter 4, we also explained that $\overline{y}$ is an unbiased estimate of $\mu$. Thus, for our example we already know that the sampling distribution should have a $\overline{y}=70\ mmHg$. The next parameter should be the spread of the curve which is the error around the mean (or the precision of $\overline{y}$) when estimating the sampling distribution, the standard error $SE_\overline{y}$. 

Say we are estimating the distribution from a sample of *n* = 100 individuals. The standard error is: 
<center>
$$
\begin{aligned}
 SE_\overline{Y}&=\frac{\sigma}{\sqrt{n}}\\\\
 &=\frac{10\ mmHg}{\sqrt{100}}\\\\
 &=1\ mmHg
\end{aligned}
$$
</center>

<br>

From this equation, it is obvious that the *shape* of the sampling distribution depends on sample size, *n*. For our example, the normal sampling distribution for $\overline{y}$ given $\mu$ and $\sigma$ is:

<br>

```{r,echo=FALSE,fig.width=4,fig.align='center',fig.height=3, fig.cap="Figure 5.  Sampling disitrubtion of ȳ.",warning=FALSE}
ggplot(bp,aes(x=bp[,1])) +
geom_density(color="white") +
theme_classic(15) +
scale_x_continuous(breaks = seq(60,80,10),limits = c(60,80)) +
ylab("Probability density") +
xlab("ȳ") + 
stat_function(fun = dnorm, n = 100, args = list(mean = 70, sd = 1),colour="red") 
```

<br>

With this information, we can estimate the probability of randomly choosing a sample with a mean in a given range (remember this is a continuous distribution) using the standard normal distribution. Of course, we would need to know the true mean ($\mu$) for this.

For our example, say that we want to estimate the probability of drawing a sample with mean > 74 mmHg from this sample of 100 individuals, Pr[$\overline{y}>74\ mmHg$]. 

First, we estimate the Z-score:
$$
\begin{aligned}
Z=\frac{\overline{y}-\mu}{SE_\overline{y}}=\frac{74-70}{1}=4
\end{aligned}
$$
<br>

From the statistical tables, we say that Pr[Z > 4] = 0.00003. So, about 0.003% of samples of size *n* = 100 in this population will results in a $\overline{y}$ equal to or greater than 74 mmHg.

<br>

<style>
body {
text-align: justify}
div.creme { background-color:#fff5e6; border-radius: 5px; padding: 20px;}
</style>
<div class = "creme">

<span style='color:blue; font-size:120%; font-weight:600'> **Info-Box!** </span>  The more we sample, the more our observations will tend to a normal distribution. The **central limit theorem** states that the mean of a large number of measurements randomly sampled approximates a normal distribution even if the measurement is not randomly distributed in the population. 

For example, in Chapter 4 we estimated the distribution of age at delivery of rhesus macaque females from a sample *n* = 500  which clearly is not normally distributed (Chapter 4, Figure 4, see below). However, when estimating the sampling distribution of the *mean* age at delivery, such distribution is normally distributed. 


```{r echo=FALSE,fig.align="center",fig.width=10, fig.asp=.35,fig.height=2}
library(png)
library(grid)
img <- readPNG("image1.png")
grid.raster(img)
```
</div>

<br>

***

<span style='color:#66023C; font-size:150%; font-weight:600'> Materials and Methods</span>

+ R and RStudio
+ R packages *ggplot2* and *tidyverse*
+ ray dataset
  

Today's activity *Size structure of round stingrays* is organized into one main exercise with multiple challenges to describe the size structure of round stingrays using the normal distribution. These exercises will also motivate inferences about the usefulness of the Z-score standardization to describe biological parameters. 

<br>

<center>
<span style='color:darkblue; font-size:200%; font-weight:500'>Size structure of round stingrays</span>
</center>
<br>

Many environmental pressures drive populations towards older ages (e.g., trophic shifts) or younger ages (e.g., size-targeted fishing). Understanding these demographic shifts is fundamental to model population processes. In his surveys, Dr. Chris Lowe, and colleagues measure the body size of round stingrays and use it as a proxy for age. Their results show that southern California offers warm-water refuge for *Urobatis halleri* of
large sizes associated to reproductive maturity. Let's explore their data following each step of the Worked example.

<br>

**1. Research question**: What is the size structure of the population of round stingrays in Seal Beach?

Import the "ray" dataset to RStudio and explore it. 

<br>

**Questions:**

  a. *What type of R object "ray" is?*
  b. *How many variables and observations "ray" has?* 
  c. *Considering the research question, what are our variables of interest and what type of variable they are?*

<br>

**A. The distribution of sizes**. 

Let's first explore the size distribution of round stingrays based on disc width. 

```{r,eval=FALSE}
# summary of disc width
summary(ray$disc_width)
```

<br>

<span style='color:red; font-size:150%; font-weight:600'> Challenge:</span> Create two useful data visualizations for these data.

```{r,eval=FALSE,echo=FALSE}
ggplot(ray,aes(y=disc_width)) +
                 geom_boxplot()

ggplot(ray,aes(x=disc_width)) +
                 geom_histogram()
```

<br>

**Questions:**

  a. *Does the distribution of disc width for round stingray follow a normal distribution?*
  b. *What statistics do we need to test whether the data follow a normal distribution?*  

<br>

Let's first estimate the statistics mean and standard deviation.
```{r,eval=FALSE}
# mean disc width 
m <- mean(ray$disc_width)
m

# standard deviation of disc width
sd <- sd(ray$disc_width)
sd
```

<br>

Using the two statistics needed to define a normal distribution, let's fit one in ggplot2 using the function **stat_function()**. The first argument of the function is the type of function, which in this case is the density probability (dnorm), followed by the sample size, and a list of arguments for mean and standard deviation. 
```{r,eval=FALSE}
# plotting the density probability of disc width
p1 <- ggplot(ray,aes(x=ray$disc_width)) +
geom_density()

p1

# fitting a normal distribution
p2 <- p1 + stat_function(fun = dnorm, n = 2427, args = list(mean = m, sd = sd),colour="red") 

p2
```

<br>

**Questions:**

  a. *Assuming a normal distribution, what range of disc width values make up for 68.3% of the data?*
  b. *Assuming a normal distribution, what range of disc width values make up for 95% of the data?*  

```{r,echo=FALSE,eval=FALSE}
m+sd
m-sd
m+2*sd
m-2*sd
```

<br>


**B. The standard normal distribution for size**.

From the equation in Step 3 from the Worked example, we can easily standardize disc width. For this, let's create a new column in our dataframe *ray* and add the standardized values. We use the "$" sign to create a new column. Let's call this new column "z".
```{r,eval=FALSE}
# estimating Z for disc width
ray$z <- (ray$disc_width-m)/sd

# checking the new column in "ray"
head(ray)

# plotting z
p3 <- ggplot(ray,aes(x=ray$z)) +
geom_density()

p3
```

<br>

Now that we have the standard normal distribution for size, we can estimate the probability that a captured round stingray has a size within a particular range of values. Say we want to estimate the probability of a stingray to have a disc width of or smaller than 13 cm, which is the maximum size for stingrays in the "small" size class. 


<span style='color:#66023C; font-size:100%; font-weight:600'> **Stop, Think, Do:** </span> What is the probability that a captured round stingray has a disc width of or smaller than 13 cm? **Stop** and review Step 3 of the Worked example. **Think** about the question and formulate it mathematically. **Do** a formal presentation of the problem using proper nomenclature and solve it.  


```{r,eval=FALSE,echo=FALSE}
z <- (13-m)/sd
#10.9% of stingrays will have sizes below 13cm.
```

<br>

Now, let's learn how to do this in R. For this, we use the function **pnorm()** which gives us the probability of getting a value equal to or less than Y under the normal curve. The first argument of the function is Y (in our case this value is 13), followed by the mean and standard deviation. 
```{r,eval=FALSE}
# probability of getting a disc width equal or less than 13 cm
pnorm(13, mean = m, sd = sd)
```

<br>

**C. The sampling distribution of mean size**.

Assuming $\overline{y}$ is a good representation of $\mu$ and $\sigma$ is a good representation of *s*, we can use the Z-score to estimate the probability of obtaining a sample with a mean in a particular range of values. Say that the Shark Lab team is pretty confident that $\overline{y}$ is close to $\mu$ given the large dataset they have analyzed. If they go back to the field and randomly sample 10 stingrays, what is the probability that the observed mean disc width will be below 15 cm, rising questions about a potential shift in the size structure of stingrays? 

But first, let's estimate $SE_\overline{y}$.
```{r,eval=FALSE}
# standard error of the sample mean
se <- sd/sqrt(10)

se

# Z-score for the sample mean
z_mean <- (15-m)/se

z_mean
```

<br>

**Questions:**

  a. *What is the probability of obtaining a mean disc width lower than 15 cm from a sample of 10 stingrays?* 
  b. *How may your conclusions change if the sample size increases to n = 100?*
  c. *Can you explain mathematically the relationship between precision and sample size?*

<br>



<span style='color:#66023C; font-size:100%; font-weight:600'> **Stop, Think, Do:** </span> using the dataset "ray", estimate the probability that a randomly sampled round stingray in Seal Beach is small, medium or large. **Stop** and review the variables in the dataset. **Think** about how to obtain a probability for a range of values under a normal curve. **Do** the analysis in R and present it! 

```{r,eval=FALSE,echo=FALSE}
small <- filter(ray,size_class=="Small")
max(small$disc_width)
sprob <- pnorm(13, mean = m, sd = sd) # proportion =<13cm

medium <- filter(ray,size_class=="Medium")
max(medium$disc_width)
mprob <- (pnorm(16.5, mean = m, sd = sd))-sprob 

lprob <- 1-(mprob+sprob)
lprob+sprob+mprob
```

<br>

<center>
**Great Work!**
</center>
<br>

*** 


<span style='color:#66023C; font-size:150%; font-weight:600'> Take-home exercise </span> 
<br> 

**Task.** Does the size structure of round stingrays at Seal Beach, California, changes annually? Do separate analyses for each year available. **Hint**: use **levels(as.factor(ray$year))** to know the years of data collection. Present the observed and the normally fitted size structure for each year. Create an annotated R script that includes the following steps; (1) data import, (2) package loading, and (3) codes for each step in the analysis, including figures. Accompany your R script with a concluding paragraph summarizing and interpreting your results. Your assignment should include two files; (1) a .doc file with the figures and paragraph, (2) an .R file containing your annotated R script. **Stick to the question and do not add unnecessary steps to your R script.**

**Guided questions for writing the concluding paragraph:**

a. *What did you find for each year?* 
b. *How did the test statistic change and why do you think it did (if it did)?*
c. *How do you explain - biologically - your results on the annual size structure of stingrays in Seal Beach?*
d. *What sources of bias may be present in the study (think about the study system and the methodology)?*

```{r,echo=FALSE,eval=FALSE}
y1=filter(ray, year=="2000")
m1=mean(y1$disc_width)
s1=sd(y1$disc_width)
y2=filter(ray, year=="2001")
m2=mean(y2$disc_width)
s2=sd(y2$disc_width)
y3=filter(ray, year=="2002")
m3=mean(y3$disc_width)
s3=sd(y3$disc_width)

#example for y1
p <- ggplot(y1,aes(x=y1$disc_width)) +
geom_density()

# fitting a normal distribution
p1 <- p + stat_function(fun = dnorm, n = 1349, args = list(mean = m1, sd = s1),colour="red") 

#example for y2
p <- ggplot(y2,aes(x=y2$disc_width)) +
geom_density()

# fitting a normal distribution
p1 <- p + stat_function(fun = dnorm, n = 970, args = list(mean = m2, sd = s2),colour="red") 


```

